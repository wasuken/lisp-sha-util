(in-package :cl-user)
(defpackage sha-util-test
  (:use :cl :prove :sha-util))
(in-package #:sha-util-test)

(subtest "base test"
  (is (sha-util:digest "hoge")
	  "31f30ddbcb1bf8446576f0e64aa4c88a9f055e3c")
  (is (sha-util:digest "test")
	  "a94a8fe5ccb19ba61c4c0873d391e987982fbbd3")
  (is (sha-util:main-loop '(1732584193 4023233417 2562383102 271733878 3285377520)
						  '(1952805748 2147483648 0 0 0 0 0 0 0 0 0 0 0 0 0 32 3905611496 1 64 3516255697 2 128 2737544099 68 3516255441 1180120901 8 512 2360241806 336 2546138774 425516503 1925076562 2054 851032890 1180119559 1594620498 1702065500 1180121031 8456 2360467375 5384 2083514729 2513296881 2295266948 33124 1842120164 589567163 2574083911 1463244250 1702066548 1594489818 2370489751 88200 4031196333 1558043225 3554939410 1702585116 2594138497 843147962 443001814 1937066413 1833912680 1699897820 3105786648 1378536 803830140 2830009825 3472786440 8479744 3431326829 605337891 3788056855 928369223 369755153 279388098 487021027 22581440 283538366 3098088424)
						  '(1518500249 1859775393 2400959708 3395469782))
	  '(2840236005 3434191782 474744947 3549555079 2553265107)))
